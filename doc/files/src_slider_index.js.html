<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, minimal-ui" />
    <title>src/slider/index.js - phoenix-ui</title>
  
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-smart" _assetsPath="../assets">
 <nav class="navbar navbar-inverse navbar-fixed-top custom-navbar" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
               <a class="navbar-brand mainlogo" href="">
             
            <img alt="phoenix-ui" src="../assets/css/logo.png" title="phoenix-ui">
            
                phoenix-ui
          </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                 <ul class="nav navbar-nav">
                    
                    <li><a href="index.html">主页</a>
                    </li>
                    
                </ul>
               <div class="navbar-form navbar-right filterAPi" autocomplete="off">
                <input type="text" id='txtSearchAPI' class="form-control search-query" placeholder="Search for API" />
                 <ul id="filterList" class="filterItems dropdown-menu" role="menu"></ul>
                </div>
            </div>
        </div>
    </nav>
    <div id="sidebar">
    <h3>模块/类</h3>
        <div id="api-tabview-filter">
            <input id='txtSearch' type="search" class="form-control" placeholder="Type to filter Modules/Classes">
        </div>
        <dl id="sidebar_list">
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/列表组件.html">列表组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/List.html">List</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/基础组件.html">基础组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Image.html">Image</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Button.html">Button</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/ButtonGroup.html">ButtonGroup</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Star.html">Star</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/布局组件.html">布局组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Col.html">Col</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Grid.html">Grid</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Row.html">Row</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/弹出框组件.html">弹出框组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Alert.html">Alert</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Dialog.html">Dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Prompt.html">Prompt</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/提示组件.html">提示组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Popover.html">Popover</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/搜索组件.html">搜索组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/SearchBar.html">SearchBar</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/操作类组件.html">操作类组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/ImageList.html">ImageList</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Popup.html">Popup</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Slider.html">Slider</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Steps.html">Steps</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Toast.html">Toast</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Accordion.html">Accordion</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/PullUp.html">PullUp</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Swipe.html">Swipe</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/标签组件.html">标签组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Icon.html">Icon</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Badge.html">Badge</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Label.html">Label</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/筛选控件.html">筛选控件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/FilterCheckbox.html">FilterCheckbox</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/FilterContainer.html">FilterContainer</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/FilterItem.html">FilterItem</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/FilterItemGroup.html">FilterItemGroup</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/FilterPanel.html">FilterPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/FilterPanelSimple.html">FilterPanelSimple</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/菜单组件.html">菜单组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/MenuBody.html">MenuBody</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/MenuHeader.html">MenuHeader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/MenuItem.html">MenuItem</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/MenuList.html">MenuList</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Menu.html">Menu</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/表单组件.html">表单组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Input.html">Input</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Radio.html">Radio</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Switch.html">Switch</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Checkbox.html">Checkbox</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/TextArea.html">TextArea</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/辅助组件.html">辅助组件</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Drag.html">Drag</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Animate.html">Animate</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/选项卡.html">选项卡</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Tab.html">Tab</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Tabset.html">Tabset</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
        </dl>
    <div class="icon-sidebar-btn icon-sidebar-btn-open"><span class="glyphicon glyphicon-chevron-left"></span>收起</div>
</div>
   
    <div class="stdoc-content">
        <div class="apidocs">
            <div id="docs-main">
                <div class="content">
                    <div class="page-header">
    <h1>src/slider/index.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums" id='src_code'>
import React,{PropTypes} from &#x27;react&#x27;
import Component from &#x27;../utils/Component&#x27;
import classnames from &#x27;classnames&#x27;

import Drag from &#x27;../drag/&#x27;

import &#x27;../style&#x27;
import &#x27;phoenix-styles/less/modules/slider.less&#x27;

/**
 * 滑动输入条组件&lt;br/&gt;
 * - 滑动进度条确定当前进度的百分比。
 * - 可通过设置process确定初始进度百分比, 范围从0-100。
 * - 可通过tipMode选择当前查看进度的方式，可选default和tooltip。
 * - 可通过placement设置当前进度提示框的位置, 可选top/bottoom(tipMode为tooltip时生效)。
 * - 可通过tipStay设置初始和松开按钮时提示是否消失，默认false不显示(tipMode为tooltip时生效)。
 * - 可通过range制定范围，默认0-100，必需是长度为2的数组，第一个数字表示初始，第二个数字表示终点。
 * - 可通过showRange判断是否在进度条前后显示范围，默认不显示。
 * - 可通过duration设置固定移动的距离，默认1。
 * - 可通过slideCallback设置拖拽进度条松开时的回调函数。
 * - 可通过disabled设置进度条只读。
 * - 使用Slider前确保父级是有宽度的元素；使用flex需要加一层宽度100%的外壳。
 *
 * 主要属性和接口：
 * - process:初始进度百分比, 默认0 &lt;br/&gt;
 * 如: &#x60;&lt;Slider progress={10}/&gt;&#x60;
 * - placement:进度提示框的位置, 默认top &lt;br/&gt;
 * 如: &#x60;&lt;Slider placement=&#x27;bottom&#x27; /&gt;&#x60;
 * - tipStay:初始和松开按钮时提示是否消失，默认false &lt;br/&gt;
 * 如: &#x60;&lt;Slider tipStay /&gt;&#x60;
 * - range:范围，默认[0,100]。 &lt;br/&gt;
 * 如: &#x60;&lt;Slider range={[20,50]} /&gt;&#x60;
 * - showRange:是否在进度条前后显示范围，默认不显示。 &lt;br/&gt;
 * 如: &#x60;&lt;Slider showRange /&gt;&#x60;
 * - duration:固定移动的距离，默认1。 &lt;br/&gt;
 * 如: &#x60;&lt;Slider duration={20} /&gt;&#x60;
 * - slideCallback:拖拽进度条松开时的回调函数 &lt;br/&gt;
 * 如: &#x60;&lt;Slider slideCallback={(progress)=&gt;{console.log(progress);} /&gt;&#x60;
 * - disabled:进度条只读, 不可操作 &lt;br/&gt;
 * 如: &#x60;&lt;Slider disabled/&gt;&#x60;
 *
 * @class Slider
 * @module 操作类组件
 * @extends Component
 * @constructor
 * @since 1.0.0
 * @demo slider|slider.js {展示}
 * @show true
 * */

export default class Slider extends Component{

    static propTypes = {
        /**
         * 样式前缀
         * @property classPrefix
         * @type String
         * @default &#x27;slider&#x27;
         * */
        classPrefix: PropTypes.string,
        /**
         * 标签tagName
         * @property componentTag
         * @type String
         * */
        componentTag:PropTypes.string,
        /**
         * 初始进程,默认0
         * @property progress
         * @type String
         * */
        progress:PropTypes.number,
        /**
         * 进程提示的位置,默认top
         * @property placement
         * @type String
         * @default &#x27;top&#x27;
         * */
        placement: PropTypes.string,
         /**
         * 范围，默认0-100，可传固定范围的数组如：[25,50]
         * @property range
         * @type Array
         * @default [0,100]
         * */
        range: PropTypes.array,
        /**
         * 是否在进度条前后显示范围
         * @property showRange
         * @type Boolean
         * @default false
         * */
        showRange: PropTypes.bool,
        /**
         * 显示提示的模式，可选[default,tooltip]
         * @property tipMode
         * @type String
         * @default &#x27;default&#x27;
         * */
        tipMode: PropTypes.string,
         /**
         * 每次移动的固定距离，默认1
         * @property duration
         * @type Number
         * @default 1
         * */
        duration: PropTypes.number,
        /**
         * 初始及松开按钮时是否显示tooltip
         * @property tipStay
         * @type Boolean
         * @default false
         * */
        tipStay: PropTypes.bool,
        /**
         * 改变进程时的回调函数
         * @method slideCallback
         * @type Function
         * */
        slideCallback: PropTypes.func
    };

    static defaultProps = {
        placement: &#x27;top&#x27;,
        progress: 0,
        range: [0,100],
        showRange: false,
        duration: 1,
        tipMode: &#x27;default&#x27;,
        tipStay: false,
        classPrefix:&#x27;slider&#x27;,
        componentTag:&#x27;div&#x27;,
        classMapping : {
            &#x27;disabled&#x27;: &#x27;disabled&#x27;,
            &#x27;top&#x27;: &#x27;tip-top&#x27;,
            &#x27;bottom&#x27;: &#x27;tip-bottom&#x27;
        }
    };

    constructor(props, context) {
        super(props, context);
        
        this.range = this.validateRange();
        this.rangeDiff = this.range[1]-this.range[0];

        this.duration = this.validateDuration();
        this.eachDur = (this.range[1]-this.range[0])/this.duration;
        
        this.state = {
            realProgress: props.progress || this.range[0],
            tipVisible: props.tipStay || false
        }
        
    }

    validateRange(){
        let {range} = this.props, defaultRange = [0,100];
        if(!range instanceof Array) return defaultRange;
        if(range.length != 2){
            console.error(&#x27;Invalid prop &#x60;range&#x60; of length not equal to 2.&#x27;);
            return defaultRange;
        } 
        if(range[0] &gt;= range[1]){
            console.error(&#x27;Invalid prop &#x60;range[0]&#x60; must be less than or equal to &#x60;range[1]&#x60;.&#x27;);
            return defaultRange;
        } 
        return range;
    }

    validateDuration(){
        let {duration} = this.props, defaultDuration = 1;
        if(duration&lt;=0) {
            console.error(&#x27;Invalid prop &#x60;duration&#x60; have to be Positive.&#x27;);
            return defaultDuration;
        }
        if((this.range[1] - this.range[0])%duration != 0){ // 不能整除的情况
            console.error(&#x27;Prop &#x60;duration&#x60; can not be divided by &#x60;range&#x60;.&#x27;);
            return defaultDuration;
        }
        return duration;
    }

    componentDidMount(){
        this.sliderLength = parseInt(this.sliderLine.offsetWidth);
        this.eachSection = this.sliderLength/this.rangeDiff*this.duration;
        // if(this.eachSection&lt;1) this.eachSection = 1; // 最小1px

        this.newProgressWidth = this.getNewProgressWidth(this.state.realProgress);
        this.setSliderPosition(this.newProgressWidth + &#x27;px&#x27;);
    }

    componentWillReceiveProps(nextProps){
        if(this.state.realProgress != nextProps.progress){
            this.setState({
                realProgress: nextProps.progress
            });

            this.newProgressWidth = this.getNewProgressWidth(nextProps.progress);
            this.setSliderPosition(this.newProgressWidth + &#x27;px&#x27;);
        }
    }

    getNewProgressWidth(realProgress){ // 保留2位小数
        return this.sliderLength * (Math.round((realProgress-this.range[0])/this.rangeDiff*100)/100);
    }

    setSliderPosition(distance){
        this.sliderProgress.style.width = distance;
        this.sliderBtn.style.left = distance;
    }

    dragCallback(event, position){
        let newProgress, nowSec;

        this.preX = position.start.x;
        this.X = position.move.x;
        this.distance = this.X - this.preX;

        this.prevProgressWidth = this.newProgressWidth + this.distance;

        if(this.prevProgressWidth &lt;= 0) this.prevProgressWidth = 0;
        if(this.prevProgressWidth &gt;= this.sliderLength) this.prevProgressWidth = this.sliderLength;

        nowSec = Math.round(this.prevProgressWidth/this.eachSection, 0);
        this.prevProgressWidth = this.eachSection*nowSec;

        newProgress = this.prevProgressWidth/this.sliderLength * this.rangeDiff + this.range[0];

        this.setSliderPosition(this.prevProgressWidth + &#x27;px&#x27;);

        this.setState({
            tipVisible: true,
            realProgress: parseInt(newProgress)
        });
    }

    dropCallback(event, position){
        let {tipStay, slideCallback} = this.props
        if(!tipStay){
            this.setState({
                tipVisible: false
            });
        }

        this.newProgressWidth = this.prevProgressWidth;

        if(slideCallback) slideCallback(this.state.realProgress);
    }

    renderSliderText(showTipMode){
        if(showTipMode){
            return &lt;div className={this.setPhPrefix(&#x27;text&#x27;)}&gt;{this.state.realProgress}&lt;/div&gt;
        }        
    }

    renderSliderRange(){
        if(this.props.showRange){
            return (
                &lt;div className={this.setPhPrefix(&#x27;range&#x27;)}&gt;
                    &lt;strong className={this.setPhPrefix(&#x27;range-start&#x27;)}&gt;{this.range[0]}&lt;/strong&gt;
                    &lt;strong className={this.setPhPrefix(&#x27;range-end&#x27;)}&gt;{this.range[1]}&lt;/strong&gt;
                &lt;/div&gt;
            );
        }else{
            return &#x27;&#x27;;
        }
    }

    renderSlider(){
        let {componentTag:Component, className, showRange, tipMode} = this.props,
            showTipMode = tipMode==&#x27;default&#x27;;

        return (
            &lt;Component {...this.otherProps} className={classnames(
                this.getProperty(true),
                className,
                showRange? this.setPhPrefix(&#x27;keep-range&#x27;,true):&#x27;&#x27;
            )}&gt;
                {this.renderSliderText(showTipMode)}
                {this.renderSliderRange()}
                &lt;div className={this.setPhPrefix(&#x27;line&#x27;)} ref={(sliderLine)=&gt;{this.sliderLine=sliderLine}}&gt;
                    &lt;div className={this.setPhPrefix(&#x27;progress&#x27;)} ref={(sliderProgress)=&gt;{this.sliderProgress=sliderProgress}}&gt;&lt;/div&gt;
                    &lt;div className={this.setPhPrefix(&#x27;content&#x27;)} ref={(sliderBtn)=&gt;{this.sliderBtn=sliderBtn}}&gt;
                        &lt;div className={classnames(this.setPhPrefix(&#x27;tip&#x27;), this.state.tipVisible &amp;&amp; !showTipMode?&#x27;show&#x27;:&#x27;hide&#x27;)}&gt;{this.state.realProgress}&lt;/div&gt;
                        &lt;Drag className={classnames(this.setPhPrefix(&#x27;btn&#x27;),&#x27;hardware&#x27;)} dragCallback={this.dragCallback.bind(this)} dropCallback={this.dropCallback.bind(this)}&gt;&lt;/Drag&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/Component&gt;
        );
    }

    render(){
        return this.renderSlider()
    }

}
    </pre>
</div>

                </div>
            </div>
        </div>
    </div>
<a id="gotoTop" class='well well-small' href='#'>
</a>
<script src="../assets/vendor/jquery/jquery-1.8.2.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/doc.js"></script>

</body>
</html>
